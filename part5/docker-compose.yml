version: "3"
services:
  proxy:
    image: 'nginx:alpine'
    ports:
      - 8080:8080
    volumes:
      - ./dist:/dist:ro
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
    logging:
      driver: json-file
      options:
        max-file: "1"
        max-size: "1m"

  app:
    image: 'python:alpine'
    volumes:
      - ./app.py:/app.py:ro
    command:
      - 'sh'
      - '-c'
      - 'pip install flask && python /app.py'
    logging:
      driver: json-file
      options:
        max-file: "1"
        max-size: "1m"
